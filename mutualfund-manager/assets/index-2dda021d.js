import{r as e,M as t,j as n,R as a,U as s,B as i,Y as r,a7 as c,a1 as o,a8 as l,a0 as d,Q as u,a2 as h,a9 as x}from"./index-e6d10f58.js";import m from"./index-5e68cc21.js";import{T as j}from"./Table-ef838cc2.js";import"./iconModule-74f1de28.js";import"./index-e3374630.js";import"./iconUtil-fd190726.js";function p(){let[p,g]=e.useState(!1),[f,k]=e.useState([]),[y,S]=e.useState(!1),[T,w]=e.useState([]),C=e.useRef(null),[I,R]=e.useState(0),[v,z]=e.useState(1),[N,O]=e.useState(10),b={current:v,pageSize:N,pageSizeOptions:["10","20","30","50","100"],showTotal:(e,t)=>t[0]+"-"+t[1]+" 共"+e+"条",showQuickJumper:!1,showSizeChanger:!0,total:I,onChange:e=>{z(e),F()},onShowSizeChange:(e,t)=>{O(t),z(1),F()}};const E=[{title:"菜单名称",dataIndex:"name",align:"center",key:"name",width:260},{title:"菜单类型",dataIndex:"menuType",align:"center",key:"menuType",render:function(e){return 0==e||1==e?"菜单":2==e?"按钮/权限":e}},{title:"icon",dataIndex:"icon",align:"center",key:"icon"},{title:"组件",dataIndex:"component",align:"center",key:"component",scopedSlots:{customRender:"component"}},{title:"路径",dataIndex:"url",align:"center",key:"url",scopedSlots:{customRender:"url"}},{title:"排序",dataIndex:"sortNo",align:"center",key:"sortNo"},{title:"操作",dataIndex:"action",fixed:"right",scopedSlots:{customRender:"action"},align:"center",width:250,render:(e,t,a)=>n.jsxs(n.Fragment,{children:[n.jsx("a",{onClick:()=>D(t),children:"编辑"}),n.jsx(d,{title:"确定要删除此菜单?",onConfirm:()=>M(t),okText:"确定",cancelText:"取消",children:n.jsx("a",{className:"delete",children:"删除"})}),n.jsx("a",{onClick:()=>B(t),children:"添加下级"})]})}];e.useEffect((()=>{F()}),[v]);const F=async()=>{g(!0);const e=await t.getmenulist({pageIndex:v,pageSize:N});0==e.data.code&&(k(e.data.result),R(e.data.result.total)),g(!1)},D=e=>{C.current.setOpen(!0),C.current.setTitle("编辑菜单"),C.current.entiForm(e);let t=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(t),C.current.setTreeData(t)},B=e=>{C.current.setOpen(!0),C.current.setRadioValue("1"),C.current.setTitle("添加下级菜单"),C.current.childenForm(e);let t=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(t),C.current.setTreeData(t)},M=async e=>{const n=await t.deletePermission({id:e.id});200==n.data.code&&(u.success(n.data.message),F())},P={onChange:(e,t)=>{w(e)}};return n.jsx(n.Fragment,{children:n.jsxs("div",{id:"permission",children:[n.jsxs(a,{justify:"space-between",className:"buttonbox",children:[n.jsxs(s,{children:[n.jsx(i,{type:"primary",icon:n.jsx(r,{}),onClick:()=>{C.current.setOpen(!0),C.current.setRadioValue("0"),C.current.setTitle("新增菜单");let e=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(e),C.current.setTreeData(e)},children:" 新增"}),0!=T.length?n.jsx(i,{icon:n.jsx(c,{}),onClick:()=>{h.confirm({title:"确认删除",icon:n.jsx(x,{}),content:"是否删除选中数据?",okText:"确认",cancelText:"取消",onOk:async()=>{let e=T.join(",");const n=await t.deleteAllPermission({ids:e});200==n.data.code&&(u.success(n.data.message),F(),w([]))}})},style:{marginLeft:"10px"},children:" 批量删除"}):""]}),n.jsx(s,{children:n.jsxs(o,{align:"center",style:{marginBottom:16},children:["父子关联: ",n.jsx(l,{checked:y,onChange:S})]})})]}),n.jsxs("div",{className:"alert",children:["已选择",n.jsx("span",{children:T.length}),"项",n.jsx("a",{onClick:()=>w([]),children:"清空"})]}),n.jsx(j,{columns:E,rowSelection:{selectedRowKeys:T,...P,checkStrictly:!y},dataSource:f,loading:p,pagination:b}),n.jsx(m,{ref:C,getlist:F})]})})}export{p as default};

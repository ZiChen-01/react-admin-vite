import{r as e,a as t,j as n,R as s,C as a,B as i,P as r,g as c,e as o,h as l,d,m as u,M as m,i as x}from"./index-218c74fb.js";import h from"./index-1bbbaf20.js";import{T as j}from"./Table-daa92147.js";import"./iconModule-0847980d.js";import"./index-83b95fd4.js";import"./index-dc1b06d6.js";import"./iconUtil-a51eb7a6.js";import"./List-8b86e5d9.js";import"./iconUtil-56e6581b.js";import"./index-68b30557.js";import"./index-09e239c2.js";function p(){let[p,g]=e.useState(!1),[f,y]=e.useState([]),[k,S]=e.useState(!1),[T,w]=e.useState([]),C=e.useRef(null),[R,I]=e.useState(0),[O,v]=e.useState(1),[z,F]=e.useState(10),N={current:O,pageSize:z,pageSizeOptions:["10","20","30","50","100"],showTotal:(e,t)=>t[0]+"-"+t[1]+" 共"+e+"条",showQuickJumper:!1,showSizeChanger:!0,total:R,onChange:e=>{v(e),E()},onShowSizeChange:(e,t)=>{F(t),v(1),E()}};const b=[{title:"菜单名称",dataIndex:"name",align:"center",key:"name",width:260},{title:"菜单类型",dataIndex:"menuType",align:"center",key:"menuType",render:function(e){return 0==e||1==e?"菜单":2==e?"按钮/权限":e}},{title:"icon",dataIndex:"icon",align:"center",key:"icon"},{title:"组件",dataIndex:"component",align:"center",key:"component",scopedSlots:{customRender:"component"}},{title:"路径",dataIndex:"url",align:"center",key:"url",scopedSlots:{customRender:"url"}},{title:"排序",dataIndex:"sortNo",align:"center",key:"sortNo"},{title:"操作",dataIndex:"action",fixed:"right",scopedSlots:{customRender:"action"},align:"center",width:250,render:(e,t,s)=>n.jsxs(n.Fragment,{children:[n.jsx("a",{onClick:()=>P(t),children:"编辑"}),n.jsx(d,{title:"确定要删除此菜单?",onConfirm:()=>U(t),okText:"确定",cancelText:"取消",children:n.jsx("a",{className:"delete",children:"删除"})}),n.jsx("a",{onClick:()=>D(t),children:"添加下级"})]})}];e.useEffect((()=>{E()}),[O]);const E=async()=>{g(!0);const e=await t.getmenulist({pageIndex:O,pageSize:z});0==e.data.code&&(y(e.data.result),I(e.data.result.total)),g(!1)},P=e=>{C.current.setOpen(!0),C.current.setTitle("编辑菜单"),C.current.entiForm(e);let t=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(t),C.current.setTreeData(t)},D=e=>{C.current.setOpen(!0),C.current.setRadioValue("1"),C.current.setTitle("添加下级菜单"),C.current.childenForm(e);let t=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(t),C.current.setTreeData(t)},U=async e=>{const n=await t.deletePermission({id:e.id});200==n.data.code&&(u.success(n.data.message),E())},V={onChange:(e,t)=>{w(e)}};return n.jsx(n.Fragment,{children:n.jsxs("div",{id:"permission",children:[n.jsxs(s,{justify:"space-between",className:"buttonbox",children:[n.jsxs(a,{children:[n.jsx(i,{type:"primary",icon:n.jsx(r,{}),onClick:()=>{C.current.setOpen(!0),C.current.setRadioValue("0"),C.current.setTitle("新增菜单");let e=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(e),C.current.setTreeData(e)},children:" 新增"}),0!=T.length?n.jsx(i,{icon:n.jsx(c,{}),onClick:()=>{m.confirm({title:"确认删除",icon:n.jsx(x,{}),content:"是否删除选中数据?",okText:"确认",cancelText:"取消",onOk:async()=>{let e=T.join(",");const n=await t.deleteAllPermission({ids:e});200==n.data.code&&(u.success(n.data.message),E(),w([]))}})},style:{marginLeft:"10px"},children:" 批量删除"}):""]}),n.jsx(a,{children:n.jsxs(o,{align:"center",style:{marginBottom:16},children:["父子关联: ",n.jsx(l,{checked:k,onChange:S})]})})]}),n.jsxs("div",{className:"alert",children:["已选择",n.jsx("span",{children:T.length}),"项",n.jsx("a",{onClick:()=>w([]),children:"清空"})]}),n.jsx(j,{columns:b,rowSelection:{selectedRowKeys:T,...V,checkStrictly:!k},dataSource:f,loading:p,pagination:N}),n.jsx(h,{ref:C,getlist:E})]})})}export{p as default};

import{r as e,a as t,j as a,a7 as s,R as n,C as r,F as l,I as i,B as o,S as d,b as c,P as u,d as m,m as h}from"./index-218c74fb.js";import{T as g}from"./index-83b95fd4.js";import{T as x}from"./Table-daa92147.js";import"./index-68b30557.js";import"./iconUtil-a51eb7a6.js";import"./List-8b86e5d9.js";import"./index-dc1b06d6.js";import"./index-09e239c2.js";import"./iconUtil-56e6581b.js";const p=e.forwardRef(((p,j)=>{let[S,y]=e.useState(!1),[k,w]=e.useState({}),[C,I]=e.useState(!1),[f,z]=e.useState([]),[N,U]=e.useState([]),[T,b]=e.useState([]),[L,R]=e.useState(""),[v,K]=e.useState("1");e.useImperativeHandle(j,(()=>({setLookVisible:y,setDetails:w,getUserlist:X,getAllUserlist:Z,setActiveKey:K})));let[F,A]=e.useState(0),[O,V]=e.useState(1),[D,J]=e.useState(10),P={current:O,pageSize:D,pageSizeOptions:["10","20","30","50","100"],showTotal:(e,t)=>t[0]+"-"+t[1]+" 共"+e+"条",showQuickJumper:!1,showSizeChanger:!0,total:F,onChange:e=>{V(e),X()},onShowSizeChange:(e,t)=>{J(t),V(1),X()}};const Q=[{title:"用户账号",dataIndex:"username",align:"center",key:"username"},{title:"用户姓名",align:"center",dataIndex:"realname",key:"realname"},{title:"工号",align:"center",key:"workNo",dataIndex:"workNo"},{title:"操作",dataIndex:"action",align:"center",render:(e,t,s)=>a.jsx(a.Fragment,{children:a.jsx(m,{title:"确定要从此角色移出此用户?",onConfirm:()=>Y(t),okText:"确定",cancelText:"取消",children:a.jsx("a",{children:"移出此用户"})})})}];let[B,E]=e.useState(0),[H,W]=e.useState(1),[q,G]=e.useState(10),M={current:H,pageSize:q,pageSizeOptions:["10","20","30","50","100"],showTotal:(e,t)=>t[0]+"-"+t[1]+" 共"+e+"条",showQuickJumper:!1,showSizeChanger:!0,total:B,onChange:e=>{W(e),Z()},onShowSizeChange:(e,t)=>{G(t),W(1),Z()}};const X=e=>{I(!0);let a={roleId:e.id,pageNo:O,pageSize:D};t.userRoleList(a).then((e=>{0==e.data.code&&(z(e.data.result.records),A(e.data.result.total)),I(!1)}))},Y=e=>{let a={userId:e.id,roleId:k.id};t.deleteUserRole(a).then((e=>{200==e.data.code&&(h.success(e.data.message),X(k))}))},Z=()=>{I(!0);let e={username:L,pageNo:H,pageSize2:q};t.getUserList(e).then((e=>{0==e.data.code&&(U(e.data.result.records),E(e.data.result.total)),I(!1)}))},$={onChange:(e,t)=>{b(e)}};return e.useEffect((()=>{}),[O]),a.jsx(a.Fragment,{children:a.jsxs(s,{title:"查看用户",open:S,closable:!1,onClose:()=>{y(!1)},width:"40%",footer:null,className:"lookUsers",children:[a.jsxs("p",{className:"lookUsers-title",children:[a.jsxs("span",{children:["当前角色：",k.roleName]}),a.jsxs("span",{children:["当前角色编码：",k.roleCode]})]}),a.jsx(g,{className:"iconDIV",defaultActiveKey:"1",onChange:e=>{K(e)},activeKey:v,items:[{label:"当前角色用户",key:"1",children:a.jsx(x,{rowKey:e=>e.id,dataSource:f,columns:Q,loading:C,pagination:P})},{label:"添加已有用户",key:"2",children:a.jsxs(a.Fragment,{children:[a.jsxs(n,{gutter:15,children:[a.jsx(r,{md:12,sm:15,children:a.jsx(l.Item,{label:"账号",children:a.jsx(i,{value:L,onChange:e=>R(e.target.value),placeholder:"请输入账号！"})})}),a.jsxs(r,{children:[a.jsx(o,{type:"primary",icon:a.jsx(d,{}),onClick:Z,children:"查询"}),a.jsx(o,{type:"primary",icon:a.jsx(c,{}),onClick:()=>{R(""),W(1),L="",H=1,Z()},style:{marginLeft:"10px"},children:"重置"}),0!=T.length?a.jsx(o,{type:"primary",icon:a.jsx(u,{}),onClick:()=>{let e={roleId:k.id,userIdList:T};t.addSysUserRole(e).then((e=>{0==e.data.code&&(h.success(e.data.message),K("1"),X(k),b([]))}))},style:{marginLeft:"10px"},children:"添加"}):""]})]}),a.jsx(x,{rowKey:e=>e.id,dataSource:N,columns:[{title:"用户账号",dataIndex:"username",align:"center",key:"username"},{title:"用户姓名",align:"center",dataIndex:"realname",key:"realname"},{title:"工号",align:"center",key:"workNo",dataIndex:"workNo"}],loading:C,pagination:M,rowSelection:{selectedRowKeys:T,...$}})]})}]})]})})}));export{p as default};

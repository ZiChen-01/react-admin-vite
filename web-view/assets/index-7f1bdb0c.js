import{r as e,j as t,R as s,C as r,F as i,I as n,B as a,S as l,b as c,P as o,E as d,f as x,D as m,d as u,e as j,a as p,m as h}from"./index-218c74fb.js";import"./moment-8e95067b.js";import g from"./index-49c5b7cf.js";import f from"./index-85e76925.js";import y from"./index-f621837d.js";import{T as k}from"./Table-daa92147.js";import"./index-83b95fd4.js";import"./index-09e239c2.js";import"./iconUtil-56e6581b.js";import"./List-8b86e5d9.js";import"./index-68b30557.js";import"./iconUtil-a51eb7a6.js";import"./index-dc1b06d6.js";function C(){let[C,S]=e.useState(!1),[b,T]=e.useState([]),[I,U]=e.useState(""),w=e.useRef(null),L=e.useRef(null),R=e.useRef(null),[v,z]=e.useState(0),[D,N]=e.useState(1),[F,M]=e.useState(10),O={current:D,pageSize:F,pageSizeOptions:["10","20","30","50","100"],showTotal:(e,t)=>t[0]+"-"+t[1]+" 共"+e+"条",showQuickJumper:!1,showSizeChanger:!0,total:v,onChange:e=>{N(e),getUserlist()},onShowSizeChange:(e,t)=>{M(t),N(1),getUserlist()}};const q=[{title:"角色编码",align:"center",dataIndex:"roleCode"},{title:"角色名称",align:"center",dataIndex:"roleName"},{title:"创建时间",dataIndex:"createTime",align:"center"},{title:"操作",dataIndex:"action",align:"center",render:(e,s,r)=>t.jsxs(t.Fragment,{children:[t.jsx("a",{onClick:()=>V(s),children:"查看用户"}),t.jsx(m,{menu:{items:[{label:t.jsx("a",{children:" 菜单授权"}),key:"1"},{label:t.jsx("a",{children:" 编辑角色"}),key:"2"},{label:t.jsx(u,{Popconfirm:!0,title:"确定要删除此角色?",onConfirm:()=>K(s),okText:"确定",cancelText:"取消",children:t.jsx("a",{children:" 删除角色"})}),key:"3",disabled:s.roleCode.includes("admin")}],onClick:e=>A(e,s)},children:t.jsx("a",{onClick:e=>{e.preventDefault()},children:t.jsx(j,{children:"更多"})})})]})}],E=()=>{S(!0);let e={roleName:I,pageNo:D,pageSize:F};p.queryRoleList(e).then((e=>{S(!1),0==e.data.code&&(T(e.data.result.records),z(e.data.result.total))}))},P=()=>{w.current.setIsModalOpen(!0),w.current.setTitle("0")},V=e=>{L.current.setLookVisible(!0),L.current.setDetails(e),L.current.getUserlist(e),L.current.getAllUserlist(),L.current.setActiveKey("1")},A=({key:e},t)=>{switch(e){case"1":R.current.setMenuVisible(!0),R.current.setDetails(t),R.current.queryMenuTreeList(t);break;case"2":w.current.setIsModalOpen(!0),w.current.setTitle("1"),w.current.setUserId(t.id),w.current.setEditForm(t)}},K=e=>{p.roleDelete({id:e.id}).then((e=>{200==e.data.code&&(h.success(e.data.message),E())}))};return e.useEffect((()=>{E()}),[D]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:"roleUserList",children:[t.jsxs(s,{gutter:24,children:[t.jsx(r,{md:6,sm:12,children:t.jsx(i.Item,{label:"角色名称",children:t.jsx(n,{value:I,onChange:e=>U(e.target.value),placeholder:"请输入角色名称！"})})}),t.jsxs(r,{md:6,sm:12,children:[t.jsx(a,{type:"primary",icon:t.jsx(l,{}),onClick:E,children:"查询"}),t.jsx(a,{type:"primary",icon:t.jsx(c,{}),onClick:()=>{U(""),I="",E()},style:{marginLeft:"10px"},children:"重置"})]})]}),t.jsxs(s,{justify:"space-between",className:"buttonbox",children:[t.jsx(r,{children:t.jsx(a,{type:"primary",icon:t.jsx(o,{}),onClick:P,children:"添加角色"})}),t.jsxs(r,{children:[t.jsx(a,{type:"primary",icon:t.jsx(d,{}),onClick:P,children:"导入"}),t.jsx(a,{type:"primary",icon:t.jsx(x,{}),onClick:P,style:{marginLeft:"10px"},children:"导出"})]})]}),t.jsx(k,{rowKey:e=>e.id,dataSource:b,columns:q,loading:C,pagination:O,expandable:{expandedRowRender:e=>t.jsxs("p",{style:{margin:0},children:["描述：",e.description]})}}),";",t.jsx(g,{ref:w,getList:E}),t.jsx(f,{ref:L}),t.jsx(y,{ref:R})]})})}export{C as default};

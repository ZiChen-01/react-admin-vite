import{r as e,l as t,an as n,_ as r,k as o,o as u,y as i,z as a,A as c,w as l,G as s,s as f,b1 as v,t as h,ak as d,al as p}from"./index-218c74fb.js";var g=e.forwardRef((function(i,a){var c=i.height,l=i.offset,s=i.children,f=i.prefixCls,v=i.onInnerResize,h=i.innerProps,d={},p={display:"flex",flexDirection:"column"};return void 0!==l&&(d={height:c,position:"relative",overflow:"hidden"},p=t(t({},p),{},{transform:"translateY(".concat(l,"px)"),position:"absolute",left:0,right:0,top:0})),e.createElement("div",{style:d},e.createElement(n,{onResize:function(e){e.offsetHeight&&v&&v()}},e.createElement("div",r({style:p,className:o(u({},"".concat(f,"-holder-inner"),f)),ref:a},h),s)))}));g.displayName="Filler";function m(e){return"touches"in e?e.touches[0].pageY:e.pageY}var b=function(t){i(r,t);var n=a(r);function r(){var t;c(this,r);for(var o=arguments.length,u=new Array(o),i=0;i<o;i++)u[i]=arguments[i];return(t=n.call.apply(n,[this].concat(u))).moveRaf=null,t.scrollbarRef=e.createRef(),t.thumbRef=e.createRef(),t.visibleTimeout=null,t.state={dragging:!1,pageY:null,startTop:null,visible:!1},t.delayHidden=function(){clearTimeout(t.visibleTimeout),t.setState({visible:!0}),t.visibleTimeout=setTimeout((function(){t.setState({visible:!1})}),2e3)},t.onScrollbarTouchStart=function(e){e.preventDefault()},t.onContainerMouseDown=function(e){e.stopPropagation(),e.preventDefault()},t.patchEvents=function(){window.addEventListener("mousemove",t.onMouseMove),window.addEventListener("mouseup",t.onMouseUp),t.thumbRef.current.addEventListener("touchmove",t.onMouseMove),t.thumbRef.current.addEventListener("touchend",t.onMouseUp)},t.removeEvents=function(){var e;window.removeEventListener("mousemove",t.onMouseMove),window.removeEventListener("mouseup",t.onMouseUp),null===(e=t.scrollbarRef.current)||void 0===e||e.removeEventListener("touchstart",t.onScrollbarTouchStart),t.thumbRef.current&&(t.thumbRef.current.removeEventListener("touchstart",t.onMouseDown),t.thumbRef.current.removeEventListener("touchmove",t.onMouseMove),t.thumbRef.current.removeEventListener("touchend",t.onMouseUp)),l.cancel(t.moveRaf)},t.onMouseDown=function(e){var n=t.props.onStartMove;t.setState({dragging:!0,pageY:m(e),startTop:t.getTop()}),n(),t.patchEvents(),e.stopPropagation(),e.preventDefault()},t.onMouseMove=function(e){var n=t.state,r=n.dragging,o=n.pageY,u=n.startTop,i=t.props.onScroll;if(l.cancel(t.moveRaf),r){var a=u+(m(e)-o),c=t.getEnableScrollRange(),s=t.getEnableHeightRange(),f=s?a/s:0,v=Math.ceil(f*c);t.moveRaf=l((function(){i(v)}))}},t.onMouseUp=function(){var e=t.props.onStopMove;t.setState({dragging:!1}),e(),t.removeEvents()},t.getSpinHeight=function(){var e=t.props,n=e.height,r=n/e.count*10;return r=Math.max(r,20),r=Math.min(r,n/2),Math.floor(r)},t.getEnableScrollRange=function(){var e=t.props;return e.scrollHeight-e.height||0},t.getEnableHeightRange=function(){return t.props.height-t.getSpinHeight()||0},t.getTop=function(){var e=t.props.scrollTop,n=t.getEnableScrollRange(),r=t.getEnableHeightRange();return 0===e||0===n?0:e/n*r},t.showScroll=function(){var e=t.props,n=e.height;return e.scrollHeight>n},t}return s(r,[{key:"componentDidMount",value:function(){this.scrollbarRef.current.addEventListener("touchstart",this.onScrollbarTouchStart),this.thumbRef.current.addEventListener("touchstart",this.onMouseDown)}},{key:"componentDidUpdate",value:function(e){e.scrollTop!==this.props.scrollTop&&this.delayHidden()}},{key:"componentWillUnmount",value:function(){this.removeEvents(),clearTimeout(this.visibleTimeout)}},{key:"render",value:function(){var t=this.state,n=t.dragging,r=t.visible,i=this.props.prefixCls,a=this.getSpinHeight(),c=this.getTop(),l=this.showScroll(),s=l&&r;return e.createElement("div",{ref:this.scrollbarRef,className:o("".concat(i,"-scrollbar"),u({},"".concat(i,"-scrollbar-show"),l)),style:{width:8,top:0,bottom:0,right:0,position:"absolute",display:s?null:"none"},onMouseDown:this.onContainerMouseDown,onMouseMove:this.delayHidden},e.createElement("div",{ref:this.thumbRef,className:o("".concat(i,"-scrollbar-thumb"),u({},"".concat(i,"-scrollbar-thumb-moving"),n)),style:{width:"100%",height:a,top:c,left:0,position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"},onMouseDown:this.onMouseDown}))}}]),r}(e.Component);function M(t){var n=t.children,r=t.setRef,o=e.useCallback((function(e){r(e)}),[]);return e.cloneElement(n,{ref:o})}var R=function(){function e(){c(this,e),this.maps=void 0,this.maps=Object.create(null)}return s(e,[{key:"set",value:function(e,t){this.maps[e]=t}},{key:"get",value:function(e){return this.maps[e]}}]),e}();function E(t,n,r){var o=e.useState(t),u=f(o,2),i=u[0],a=u[1],c=e.useState(null),l=f(c,2),s=l[0],v=l[1];return e.useEffect((function(){var e=function(e,t,n){var r,o,u=e.length,i=t.length;if(0===u&&0===i)return null;u<i?(r=e,o=t):(r=t,o=e);var a={__EMPTY_ITEM__:!0};function c(e){return void 0!==e?n(e):a}for(var l=null,s=1!==Math.abs(u-i),f=0;f<o.length;f+=1){var v=c(r[f]);if(v!==c(o[f])){l=f,s=s||v!==c(o[f+1]);break}}return null===l?null:{index:l,multiple:s}}(i||[],t||[],n);void 0!==(null==e?void 0:e.index)&&(null==r||r(e.index),v(t[e.index])),a(t)}),[t]),[s]}var S="object"===("undefined"==typeof navigator?"undefined":h(navigator))&&/Firefox/i.test(navigator.userAgent);const y=function(t,n){var r=e.useRef(!1),o=e.useRef(null);var u=e.useRef({top:t,bottom:n});return u.current.top=t,u.current.bottom=n,function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e<0&&u.current.top||e>0&&u.current.bottom;return t&&n?(clearTimeout(o.current),r.current=!1):n&&!r.current||(clearTimeout(o.current),r.current=!0,o.current=setTimeout((function(){r.current=!1}),50)),!r.current&&n}};var w=14/15;var T=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","component","onScroll","onVisibleChange","innerProps"],H=[],L={overflowY:"auto",overflowAnchor:"none"};function x(n,i){var a=n.prefixCls,c=void 0===a?"rc-virtual-list":a,s=n.className,m=n.height,x=n.itemHeight,D=n.fullHeight,k=void 0===D||D,C=n.style,Y=n.data,N=n.children,P=n.itemKey,I=n.virtual,U=n.component,z=void 0===U?"div":U,_=n.onScroll,j=n.onVisibleChange,A=n.innerProps,K=p(n,T),O=!(!1===I||!m||!x),F=O&&Y&&x*Y.length>m,V=e.useState(0),G=f(V,2),W=G[0],q=G[1],B=e.useState(!1),J=f(B,2),Q=J[0],X=J[1],Z=o(c,s),$=Y||H,ee=e.useRef(),te=e.useRef(),ne=e.useRef(),re=e.useCallback((function(e){return"function"==typeof P?P(e):null==e?void 0:e[P]}),[P]),oe={getKey:re};function ue(e){q((function(t){var n=function(e){var t=e;Number.isNaN(Se.current)||(t=Math.min(t,Se.current));return t=Math.max(t,0),t}("function"==typeof e?e(t):e);return ee.current.scrollTop=n,n}))}var ie=e.useRef({start:0,end:$.length}),ae=e.useRef(),ce=E($,re),le=f(ce,1)[0];ae.current=le;var se=function(t,n,r){var o=e.useState(0),u=f(o,2),i=u[0],a=u[1],c=e.useRef(new Map),s=e.useRef(new R),h=e.useRef();function d(){l.cancel(h.current)}function p(){d(),h.current=l((function(){c.current.forEach((function(e,t){if(e&&e.offsetParent){var n=v(e),r=n.offsetHeight;s.current.get(t)!==r&&s.current.set(t,n.offsetHeight)}})),a((function(e){return e+1}))}))}return e.useEffect((function(){return d}),[]),[function(e,o){var u=t(e),i=c.current.get(u);o?(c.current.set(u,o),p()):c.current.delete(u),!i!=!o&&(o?null==n||n(e):null==r||r(e))},p,s.current,i]}(re,null,null),fe=f(se,4),ve=fe[0],he=fe[1],de=fe[2],pe=fe[3],ge=e.useMemo((function(){if(!O)return{scrollHeight:void 0,start:0,end:$.length-1,offset:void 0};var e;if(!F)return{scrollHeight:(null===(e=te.current)||void 0===e?void 0:e.offsetHeight)||0,start:0,end:$.length-1,offset:void 0};for(var t,n,r,o=0,u=$.length,i=0;i<u;i+=1){var a=$[i],c=re(a),l=de.get(c),s=o+(void 0===l?x:l);s>=W&&void 0===t&&(t=i,n=o),s>W+m&&void 0===r&&(r=i),o=s}return void 0===t&&(t=0,n=0,r=Math.ceil(m/x)),void 0===r&&(r=$.length-1),{scrollHeight:o,start:t,end:r=Math.min(r+1,$.length),offset:n}}),[F,O,W,$,pe,m]),me=ge.scrollHeight,be=ge.start,Me=ge.end,Re=ge.offset;ie.current.start=be,ie.current.end=Me;var Ee=me-m,Se=e.useRef(Ee);Se.current=Ee;var ye=W<=0,we=W>=Ee,Te=y(ye,we);var He=function(t,n,r,o){var u=e.useRef(0),i=e.useRef(null),a=e.useRef(null),c=e.useRef(!1),s=y(n,r);return[function(e){if(t){l.cancel(i.current);var n=e.deltaY;u.current+=n,a.current=n,s(n)||(S||e.preventDefault(),i.current=l((function(){var e=c.current?10:1;o(u.current*e),u.current=0})))}},function(e){t&&(c.current=e.detail===a.current)}]}(O,ye,we,(function(e){ue((function(t){return t+e}))})),Le=f(He,2),xe=Le[0],De=Le[1];!function(t,n,r){var o,u=e.useRef(!1),i=e.useRef(0),a=e.useRef(null),c=e.useRef(null),l=function(e){if(u.current){var t=Math.ceil(e.touches[0].pageY),n=i.current-t;i.current=t,r(n)&&e.preventDefault(),clearInterval(c.current),c.current=setInterval((function(){(!r(n*=w,!0)||Math.abs(n)<=.1)&&clearInterval(c.current)}),16)}},s=function(){u.current=!1,o()},f=function(e){o(),1!==e.touches.length||u.current||(u.current=!0,i.current=Math.ceil(e.touches[0].pageY),a.current=e.target,a.current.addEventListener("touchmove",l),a.current.addEventListener("touchend",s))};o=function(){a.current&&(a.current.removeEventListener("touchmove",l),a.current.removeEventListener("touchend",s))},d((function(){return t&&n.current.addEventListener("touchstart",f),function(){var e;null===(e=n.current)||void 0===e||e.removeEventListener("touchstart",f),o(),clearInterval(c.current)}}),[t])}(O,ee,(function(e,t){return!Te(e,t)&&(xe({preventDefault:function(){},deltaY:e}),!0)})),d((function(){function e(e){O&&e.preventDefault()}return ee.current.addEventListener("wheel",xe),ee.current.addEventListener("DOMMouseScroll",De),ee.current.addEventListener("MozMousePixelScroll",e),function(){ee.current&&(ee.current.removeEventListener("wheel",xe),ee.current.removeEventListener("DOMMouseScroll",De),ee.current.removeEventListener("MozMousePixelScroll",e))}}),[O]);var ke=function(t,n,r,o,u,i,a,c){var s=e.useRef();return function(e){if(null!=e){if(l.cancel(s.current),"number"==typeof e)a(e);else if(e&&"object"===h(e)){var f,v=e.align;f="index"in e?e.index:n.findIndex((function(t){return u(t)===e.key}));var d=e.offset,p=void 0===d?0:d;!function e(c,h){if(!(c<0)&&t.current){var d=t.current.clientHeight,g=!1,m=h;if(d){for(var b=h||v,M=0,R=0,E=0,S=Math.min(n.length,f),y=0;y<=S;y+=1){var w=u(n[y]);R=M;var T=r.get(w);M=E=R+(void 0===T?o:T),y===f&&void 0===T&&(g=!0)}var H=null;switch(b){case"top":H=R-p;break;case"bottom":H=E-d+p;break;default:var L=t.current.scrollTop;R<L?m="top":E>L+d&&(m="bottom")}null!==H&&H!==t.current.scrollTop&&a(H)}s.current=l((function(){g&&i(),e(c-1,m)}),2)}}(3)}}else c()}}(ee,$,de,x,re,he,ue,(function(){var e;null===(e=ne.current)||void 0===e||e.delayHidden()}));e.useImperativeHandle(i,(function(){return{scrollTo:ke}})),d((function(){if(j){var e=$.slice(be,Me+1);j(e,$)}}),[be,Me,$]);var Ce=function(t,n,r,o,u,i){var a=i.getKey;return t.slice(n,r+1).map((function(t,r){var i=u(t,n+r,{}),c=a(t);return e.createElement(M,{key:c,setRef:function(e){return o(t,e)}},i)}))}($,be,Me,ve,N,oe),Ye=null;return m&&(Ye=t(u({},k?"height":"maxHeight",m),L),O&&(Ye.overflowY="hidden",Q&&(Ye.pointerEvents="none"))),e.createElement("div",r({style:t(t({},C),{},{position:"relative"}),className:Z},K),e.createElement(z,{className:"".concat(c,"-holder"),style:Ye,ref:ee,onScroll:function(e){var t=e.currentTarget.scrollTop;t!==W&&ue(t),null==_||_(e)}},e.createElement(g,{prefixCls:c,height:me,offset:Re,onInnerResize:he,ref:te,innerProps:A},Ce)),O&&e.createElement(b,{ref:ne,prefixCls:c,scrollTop:W,height:m,scrollHeight:me,count:$.length,onScroll:function(e){ue(e)},onStartMove:function(){X(!0)},onStopMove:function(){X(!1)}}))}var D=e.forwardRef(x);D.displayName="List";export{D as L};

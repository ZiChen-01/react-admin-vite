import{r as e,j as t,J as n,K as a,V as s,a3 as r,a7 as i,S as c,g as o,a4 as l,P as d,m as u,M as h,a8 as m}from"../.store/.store.788e8884.js";import{r as x}from"../index.69c252cd.js";import g from"../permissionModule/index.81ccd688.js";import"../permissionModule/iconModule.d32dd410.js";function p(){let[p,j]=e.useState(!1),[f,y]=e.useState([]),[k,S]=e.useState(!1),[T,w]=e.useState([]),C=e.useRef(null),[I,R]=e.useState(0),[v,z]=e.useState(1),[N,O]=e.useState(10),E={current:v,pageSize:N,pageSizeOptions:["10","20","30","50","100"],showTotal:(e,t)=>t[0]+"-"+t[1]+" 共"+e+"条",showQuickJumper:!1,showSizeChanger:!0,total:I,onChange:e=>{z(e),M()},onShowSizeChange:(e,t)=>{O(t),z(1),M()}};const F=[{title:"菜单名称",dataIndex:"name",align:"center",key:"name",width:260},{title:"菜单类型",dataIndex:"menuType",align:"center",key:"menuType",render:function(e){return 0==e||1==e?"菜单":2==e?"按钮/权限":e}},{title:"icon",dataIndex:"icon",align:"center",key:"icon"},{title:"组件",dataIndex:"component",align:"center",key:"component",scopedSlots:{customRender:"component"}},{title:"路径",dataIndex:"url",align:"center",key:"url",scopedSlots:{customRender:"url"}},{title:"排序",dataIndex:"sortNo",align:"center",key:"sortNo"},{title:"操作",dataIndex:"action",fixed:"right",scopedSlots:{customRender:"action"},align:"center",width:250,render:(e,n,a)=>t.jsxs(t.Fragment,{children:[t.jsx("a",{onClick:()=>b(n),children:"编辑"}),t.jsx(d,{title:"确定要删除此菜单?",onConfirm:()=>P(n),okText:"确定",cancelText:"取消",children:t.jsx("a",{className:"delete",children:"删除"})}),t.jsx("a",{onClick:()=>D(n),children:"添加下级"})]})}];e.useEffect((()=>{M()}),[v]);const M=async()=>{j(!0);const e=await x.getmenulist({pageIndex:v,pageSize:N});0==e.data.code&&(y(e.data.result),R(e.data.result.total)),j(!1)},b=e=>{C.current.setOpen(!0),C.current.setTitle("编辑菜单"),C.current.entiForm(e);let t=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(t),C.current.setTreeData(t)},D=e=>{C.current.setOpen(!0),C.current.setRadioValue("1"),C.current.setTitle("添加下级菜单"),C.current.childenForm(e);let t=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(t),C.current.setTreeData(t)},P=async e=>{const t=await x.deletePermission({id:e.id});200==t.data.code&&(u.success(t.data.message),M())},V={onChange:(e,t)=>{w(e)}};return t.jsx(t.Fragment,{children:t.jsxs("div",{id:"permission",children:[t.jsxs(n,{justify:"space-between",className:"buttonbox",children:[t.jsxs(a,{children:[t.jsx(s,{type:"primary",icon:t.jsx(r,{}),onClick:()=>{C.current.setOpen(!0),C.current.setRadioValue("0"),C.current.setTitle("新增菜单");let e=f;!function e(t){t.forEach((t=>{t.value=t.key,t.children&&e(t.children)}))}(e),C.current.setTreeData(e)},children:" 新增"}),0!=T.length?t.jsx(s,{icon:t.jsx(i,{}),onClick:()=>{h.confirm({title:"确认删除",icon:t.jsx(m,{}),content:"是否删除选中数据?",okText:"确认",cancelText:"取消",onOk:async()=>{let e=T.join(",");const t=await x.deleteAllPermission({ids:e});200==t.data.code&&(u.success(t.data.message),M(),w([]))}})},style:{marginLeft:"10px"},children:" 批量删除"}):""]}),t.jsx(a,{children:t.jsxs(c,{align:"center",style:{marginBottom:16},children:["父子关联: ",t.jsx(o,{checked:k,onChange:S})]})})]}),t.jsxs("div",{className:"alert",children:["已选择",t.jsx("span",{children:T.length}),"项",t.jsx("a",{onClick:()=>w([]),children:"清空"})]}),t.jsx(l,{columns:F,rowSelection:{selectedRowKeys:T,...V,checkStrictly:!k},dataSource:f,loading:p,pagination:E}),t.jsx(g,{ref:C,getlist:M})]})})}export{p as default};
